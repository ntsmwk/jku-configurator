/**
 * @preserve jQuery PeriodPicker plugin v6.1.8
 * @homepage http://xdsoft.net/jqplugins/periodpicker/
 * @copyright (c) 2018 xdsoft.net Chupurnov Valeriy
 * @license PRO http://xdsoft.net/jqplugins/periodpicker/license/
 */
!function(a,b,c){"use strict";function d(b,c,e){var f,g=e||new Date;return g.isTW=!0,g.weekdays=function(a){var b,c,d=moment.weekdaysShort();for(b=d.splice(1),b[6]=d[0],d=b,b=d.splice(a-1),c=0;c<a-1;c+=1)b.push(d[c]);return b},g.clone=function(a,b,c,e,f,h){var i=new d((!1),(!1),new Date(g.getTime()));return e&&i.setHours(e),f&&i.setMinutes(f),h&&i.setSeconds(h),a&&i.setFullYear(a),b&&i.setMonth(b),c&&i.setDate(c),i},g.inRange=function(a,b){return moment(a).isBetween(b[0],b[1],"day")||moment(a).isSame(b[0],"day")||moment(a).isSame(b[1],"day")},g.isValid=function(){return"[object Date]"===Object.prototype.toString.call(g)&&!isNaN(g.getTime())},g.parseStr=function(b,c){var e;return e="string"==typeof b?moment(b,c):"date"===a.type(b)?new d(0,0,new Date(b.getTime())):b,e&&e.isValid()?g=e.isTW?e:new d(0,0,e.toDate()):null},g.isEqualDate=function(a,b){return!!(a&&a.isValid()&&b&&b.isValid())&&(a.getDate()===b.getDate()&&a.getMonth()===b.getMonth()&&a.getMonth()===b.getMonth())},g.format=function(a){return f=moment(g).format(a),new RegExp("^[0-9]+$").test(f)?parseInt(f,10):f},g.countDaysInMonth=function(){return new Date(g.getFullYear(),g.getMonth()+1,0).getDate()},b&&c&&g.parseStr(b,c),g}function e(j,k){var l,m=this,n=[],o=a.extend(!0,{},a.fn.periodpicker.defaultOptions,k),p=function(a){return void 0!==o.i18n[o.lang]&&void 0!==o.i18n[o.lang][a]?o.i18n[o.lang][a]:a};m.picker=a('<div class="period_picker_box xdsoft_noselect" style="">                <div class="period_picker_resizer"></div>                    <div class="period_picker_head">                        <span class="period_picker_head_title"></span>                        <span class="period_picker_max_min" title="'+p("Open fullscreen")+'"></span>                        <span class="period_picker_close" title="'+p("Close")+'"></span>                    </div>                    <div class="period_picker_years">                        <div class="period_picker_years_inner">                            <div class="period_picker_years_selector">                                <div class="period_picker_years_selector_container" style="width: 5960px; left: 0;">                                </div>                            </div>                        </div>                    </div>                    <div class="period_picker_work">                        <a href="" class="xdsoft_navigate xdsoft_navigate_prev"></a>                        <div class="period_picker_timepicker_box">                            <input data-index="0" class="timepicker" type="hidden"/>                        </div>                    <div class="period_picker_days">                        <table>                            <tbody>                            </tbody>                        </table>                    </div>                    <div class="period_picker_timepicker_box">                        <input data-index="1"  class="timepicker" type="hidden">                    </div>                    <a href="" class="xdsoft_navigate xdsoft_navigate_next"></a>                </div>                <div class="period_picker_submit_shadow"></div>                <div class="period_picker_submit_dates">                    <span class="period_picker_from_time_block period_picker_time">                        <span class="input_box"><input data-index="0"  class="input_control period_picker_from_time"></span>                    </span>                    <span class="period_picker_from_block period_picker_date">                        <span class="input_box"><input class="input_control period_picker_from" maxlength="10"></span>                    </span>                    <span class="period_picker_date_separator">&#8212;</span>                    <span class="period_picker_to_block period_picker_date">                        <span class="input_box"><input class="input_control period_picker_to" maxlength="10"></span>                    </span>                    <span class="period_picker_to_time_block period_picker_time">                        <span class="input_box"><input data-index="1" class="input_control period_picker_to_time"></span>                    </span>                    <button class="period_picker_show period_picker_ok" role="button" type="button">                        <span class="button_text">'+p("OK")+'</span>                    </button>                    <button class="period_picker_show period_picker_today" role="button" type="button">                        <span class="button_text">'+p("Today")+'</span>                    </button>                    <button class="period_picker_show period_picker_clear" role="button" type="button">                        <span class="button_text">'+p("Clear")+"</span>                    </button>                </div>            </div>"),m.pickerdays=m.picker.find(".period_picker_days"),m.calendarbox=m.pickerdays.find("> table > tbody"),m.yearsline=m.picker.find(".period_picker_years_selector_container"),m.yearslineparent=m.picker.find(".period_picker_years_selector"),m.timepicker=m.picker.find(".period_picker_timepicker_box"),m.button=a('<div class="period_picker_input '+o.buttonClassSuffix+'" role="button"><span class="period_button_text"><span class="period_button_content_wrapper"><span class="period_button_content"><span class="icon_calendar"></span><span class="period_button_content_body">'+p(o.norange?"Choose date":"Choose period")+'</span><span class="icon_clear"></span></span></span></span></div>'),m.startinput=a(o.start?o.start:j),m.endinput=a(o.end),m.startinput.attr("autocomplete","off"),m.endinput.attr("autocomplete","off"),m.periodtime=[[]],m.period=[],m.director=0;var q=function(){var b;moment.locale(o.lang),m.picker.toggleClass("period_picker_maximize",o.fullsize),i(m.picker.find(".period_picker_resizer"),o.resizeButton),i(m.picker.find(".period_picker_head_title").html(p(o.norange?"Select date":"Select period")),o.title),i(m.picker.find(".period_picker_max_min"),o.fullsizeButton),i(m.picker.find(".period_picker_close"),o.closeButton&&!o.inline),i(m.picker.find(".period_picker_years"),o.yearsLine),i(m.picker.find(".xdsoft_navigate"),o.navigate),i(m.picker.find(".period_picker_timepicker_box").eq(0),o.timepicker&&void 0!==a.fn.TimePicker&&!(o.norange&&o.timePickerInRight)),i(m.picker.find(".period_picker_timepicker_box").eq(1),o.timepicker&&void 0!==a.fn.TimePicker&&(!o.norange||o.timePickerInRight)),m.picker.find(".period_picker_timepicker_box").eq(0).find("input").data("index",0),m.picker.find(".period_picker_timepicker_box").eq(1).find("input").data("index",1),o.norange&&o.timePickerInRight&&(m.picker.find(".period_picker_timepicker_box").eq(1).find("input").data("index",0),m.picker.find(".period_picker_timepicker_box").eq(0).find("input").data("index",1)),m.picker.find(".period_picker_date,.period_picker_date_separator").css("visibility",o.showDatepickerInputs?"":"hidden"),i(m.picker.find(".period_picker_from_time_block"),o.timepicker&&void 0!==a.fn.TimePicker),m.picker.find(".period_picker_from_time_block").css("visibility",o.showTimepickerInputs?"":"hidden"),i(m.picker.find(".period_picker_to_time_block"),o.timepicker&&void 0!==a.fn.TimePicker&&!o.norange),m.picker.find(".period_picker_to_time_block").css("visibility",o.showTimepickerInputs?"":"hidden"),i(m.picker.find(".period_picker_ok"),o.okButton&&!o.inline),i(m.picker.find(".period_picker_today"),o.todayButton),i(m.picker.find(".period_picker_clear"),o.clearButton),i(m.button.find(".period_button_content .icon_clear"),o.clearButtonInButton),o.tabIndex!==!1&&m.button.attr("tabindex",o.tabIndex),!o.withoutBottomPanel&&(o.todayButton||o.clearButton||o.okButton&&!o.inline||o.showDatepickerInputs||o.showTimepickerInputs&&o.timepicker&&void 0!==a.fn.TimePicker)||(m.picker.addClass("without_bottom_panel"),o.withoutBottomPanel=!0,o.someYOffset=0),o.yearsLine||m.picker.addClass("without_yearsline"),o.title||o.fullsizeButton||o.closeButton&&!o.inline||m.picker.addClass("without_header"),o.timepicker&&void 0!==a.fn.TimePicker&&m.picker.addClass("with_first_timepicker"),o.timepicker&&void 0!==a.fn.TimePicker&&!o.norange&&m.picker.addClass("with_second_timepicker"),o.animation&&m.picker.addClass("animation"),m.picker.removeClass("xdsoft_norange xdsoft_norange_timepickerinright"),o.norange&&(m.picker.addClass("xdsoft_norange"),o.timePickerInRight&&m.picker.addClass("xdsoft_norange_timepickerinright")),o.inline&&m.picker.addClass("xdsoft_inline"),b=function(b){var c,d=!1;if(void 0!==o[b]&&a.isFunction(o[b])){for(c=0;c<m[b].length;c+=1)if(o[b]===m[b][c]){d=!0;break}d||m[b].push(o[b])}},b("onAfterShow"),b("onAfterHide"),b("onAfterRegenerate"),m.maxdate=!!o.maxDate&&new d(o.maxDate,o.formatDate),m.mindate=!!o.minDate&&new d(o.minDate,o.formatDate),null===o.yearsPeriod[0]&&m.mindate&&(o.yearsPeriod[0]=m.mindate.getFullYear()),null===o.yearsPeriod[1]&&m.maxdate&&(o.yearsPeriod[1]=m.maxdate.getFullYear()),null===o.yearsPeriod[0]&&(o.yearsPeriod[0]=o.yearsPeriod[1]?o.yearsPeriod[1]-40:(new Date).getFullYear()-20),null===o.yearsPeriod[1]&&(o.yearsPeriod[1]=o.yearsPeriod[0]+40),m.monthcount=o.cells[0]*o.cells[1];var c;m.maxdate&&(c=m.maxdate.clone(null,m.maxdate.clone().getMonth()-o.cells[0]*o.cells[1]+1)),null===o.startYear&&(m.mindate?o.startYear=m.mindate.getFullYear():m.maxdate?o.startYear=c.getFullYear():o.startYear=(new Date).getFullYear()),null===o.startMonth&&(m.mindate?o.startMonth=m.mindate.getMonth()+1:m.maxdate?o.startMonth=c.getMonth()+1:o.startMonth=(new Date).getMonth()+1),m.picker.css({width:o.cells[1]*o.monthWidthInPixels+(o.timepicker&&a.fn.TimePicker?87*(o.norange?1:2):0)+50,height:o.cells[0]*o.monthHeightInPixels+o.someYOffset})},r=function(){m.picker.find("input.period_picker_from").val(void 0!==m.period?m.period:""),m.picker.find("input.period_picker_to").val(void 0!==m.period[1]?m.period[1]:m.picker.find("input.period_picker_from").val())},s=function(){o.timepicker&&m.periodtime.length&&m.periodtime[0].length&&(null!==m.period[0]&&m.period[0].format&&m.periodtime[0][0].format&&(m.period[0].setSeconds(m.periodtime[0][0].getSeconds()),m.period[0].setMinutes(m.periodtime[0][0].getMinutes()),m.period[0].setHours(m.periodtime[0][0].getHours())),null!==m.periodtime[0][1]&&null!==m.period[1]&&m.period[1].format&&m.periodtime[0][1].format&&(m.period[1].setSeconds(m.periodtime[0][1].getSeconds()),m.period[1].setMinutes(m.periodtime[0][1].getMinutes()),m.period[1].setHours(m.periodtime[0][1].getHours())))},t=function(){if(o.timepicker&&void 0!==a.fn.TimePicker){var b=new d,c=m.timepicker.find("input.timepicker"),e=m.picker.find(".period_picker_submit_dates .period_picker_time input");m.periodtime[0][0]&&(a.fn.TimePicker&&c.eq(0).TimePicker("setValue",m.periodtime[0][0],!0),e.eq(0).is(":focus")||e.eq(0).val(m.periodtime[0][0].format(o.timepickerOptions.inputFormat))),!o.norange&&m.periodtime[0][1]&&(a.fn.TimePicker&&c.eq(1).TimePicker("setValue",m.periodtime[0][1],!0),e.eq(1).is(":focus")||e.eq(1).val(m.periodtime[0][1].format(o.timepickerOptions.inputFormat))),!o.norange&&o.useTimepickerLimits&&b.isEqualDate(m.period[0],m.period[1])&&(0===m.currentTimepickerIndex?c.eq(1).TimePicker("setMin",c.eq(0).val()).TimePicker("setMin",!1):c.eq(0).TimePicker("setMax",c.eq(1).val()).TimePicker("setMax",!1))}},u=function(){var a,b=[];return t(),m.startinput.length&&m.period&&m.period.length&&(s(),a=o.timepicker?o.formatDateTime:o.formatDate,m.period[0]&&m.period[0].format&&b.push(m.period[0].format(a)),m.period[1]&&m.period[1].format&&b.push(m.period[1].format(a))),b},v=function(b){if(o[b]&&a.isFunction(o[b])&&o[b].call(m)===!1)return!1},w=function(){var a=u();a.length?(a[0]&&m.startinput.val()!==a[0]&&m.startinput.val(a[0]),a[1]&&m.endinput.val()!==a[1]&&m.endinput.val(a[1])):(m.startinput.val(""),m.endinput.val("")),m.oldStringRange!==a.join("-")&&(m.oldStringRange=a.join("-"),m.startinput.trigger("change"),m.endinput.trigger("change"),a[0]&&(v("onChange"),a[1]&&a[0]!==a[1]&&v("onChangePeriod")))},x=function(){var a,b=[];return m.period.length&&(s(),a=o.timepicker?[o.formatDecoreDateTimeWithYear||o.formatDecoreDateTime||o.formatDateTime,o.formatDecoreDateTimeWithoutMonth||o.formatDecoreDateTime||o.formatDateTime,o.formatDecoreDateTime||o.formatDateTime,o.formatDateTime]:[o.formatDecoreDateWithYear||o.formatDecoreDate||o.formatDate,o.formatDecoreDateWithoutMonth||o.formatDecoreDate||o.formatDate,o.formatDecoreDate||o.formatDate,o.formatDate],void 0!==m.period[1]&&m.period[1]&&void 0!==m.period[1].format&&m.period[1].format&&m.period[0].format(a[3])!==m.period[1].format(a[3])?(b.push(m.period[0].format(m.period[0].format("YYYY")!==m.period[1].format("YYYY")?a[0]:m.period[0].format("M")!==m.period[1].format("M")?a[2]:a[1])),b.push(m.period[1].format(a[0]))):b.push(m.period[0].format(a[0]))),b},y=function(){var a=x(),b=m.button;a.length?(1===a.length?b.find(".period_button_content_body").html(a[0]):b.find(".period_button_content_body").html("<span>"+a[0]+'</span><span class="period_button_dash">&#8212;</span><span>'+a[1]+"</span>"),o.clearButtonInButton&&i(b.find(".period_button_content .icon_clear"),!0)):(b.find(".period_button_content_body").html(p(o.norange?"Choose date":"Choose period")),o.clearButtonInButton&&setTimeout(function(){i(b.find(".period_button_content .icon_clear"),!1)},2*o.defaultTimeout))},z=function(){var b=new d;m.picker.is(":hidden")||(m.picker.find(".period_picker_cell.period_picker_selected").removeClass("period_picker_selected"),m.period.length?(m.picker.find(".period_picker_cell").each(function(){var c=b.parseStr(a(this).data("date"),o.formatDate);b.inRange(c,m.period)&&a(this).addClass("period_picker_selected")}),m.picker.find(".period_picker_years_period").css({width:Math.floor(o.yearSizeInPixels/365*Math.abs(moment(m.period[1]).diff(m.period[0],"day")))+"px",left:Math.floor(o.yearSizeInPixels/365*-moment([o.yearsPeriod[0],1,1]).diff(m.period[0],"day"))}),m.picker.find("input.period_picker_from:not(:focus)").val(void 0!==m.period[0]&&m.period[0]?m.period[0].format(o.formatDate):""),m.picker.find("input.period_picker_to:not(:focus)").val(void 0!==m.period[1]&&m.period[1]?m.period[1].format(o.formatDate):m.picker.find("input.period_picker_from").val()),m.picker.find("input.period_picker_from:not(:focus),input.period_picker_to:not(:focus)").trigger("change")):m.picker.find("input.period_picker_from:not(:focus),input.period_picker_to:not(:focus)").val("")),y(),w()},A=function(a,b){var c=new d;m.periodtime[0][0]=c.parseStr(a,o.timepickerOptions.inputFormat),o.norange?m.periodtime[0][1]=m.periodtime[0][0]:(m.periodtime[0][1]=c.parseStr(b,o.timepickerOptions.inputFormat),null===m.periodtime[0][0]&&m.periodtime[0][1]&&(m.periodtime[0][0]=m.periodtime[0][1])),null===m.periodtime[0][0]&&(m.periodtime[0]=[]),y(),w()},B=function(b){m.oldStringRange=u().join("-"),m.currentTimepickerIndex=0;var c,e=new d;o.norange&&(m.director=0);var f=[m.period[0]?m.period[0].clone():void 0,m.period[1]?m.period[1].clone():void 0];if(a.isArray(b))m.period=[e.parseStr(b[0],o.formatDate),e.parseStr(b[1],o.formatDate)],null===m.period[0]&&(m.period=[]),m.director=0;else{if(void 0===m.period&&(m.period=[]),m.period[o.norange?0:m.director]=e.parseStr(b,o.formatDate),null===m.period[m.director])return m.period=[],void z();m.director||(m.period[1]=m.period[m.director].clone()),m.period[0]>m.period[1]&&(c=m.period[0],m.period[0]=m.period[1],m.period[1]=c),m.director=m.director?0:1}o.norange&&m.period[0]&&m.period[1]&&m.period[1]!==m.period[0]&&(m.period[1]=m.period[0].clone()),z(),o.hideAfterSelect&&m.period[0]&&m.period[1]&&m.period[0]!==m.period[1]&&T(),m.month=m.period.length?m.period[0].getMonth()+1:parseInt(o.startMonth,10),m.year=m.period.length?m.period[0].getFullYear():parseInt(o.startYear,10),f[0]!==m.period[0]&&(f[0]||"").toString()!==(m.period[0]||"").toString()&&v(f[0]?"onFromChanged":"onFromSelected"),f[1]!==m.period[1]&&(f[1]||"").toString()!==(m.period[1]||"").toString()&&((m.period[1]||"").toString()!==(m.period[0]||"").toString()||f[1]&&(f[1]||"").toString()!==(m.period[0]||"").toString())&&v(f[1]&&(f[0]||"").toString()!==(m.period[0]||"").toString()?"onToChanged":"onToSelected")},C=function(){clearTimeout(m.timer2),m.timer2=setTimeout(function(){var a=Math.abs(parseInt(m.yearsline.css("left"),10)),b=m.picker.find(".period_picker_years_dragger"),c=parseInt(b.css("left"),10);c<a?m.yearsline.css("left",-c+"px"):c+b.width()>a+m.yearslineparent.width()&&m.yearsline.css("left",-(c+b.width()-m.yearslineparent.width())+"px")},o.defaultTimeout)},D=function(a,b,c,d){a.setFullYear(b),a.setMonth(c),a.setDate(d)},E=function(){var a=new Date;return D(a,m.year,m.month-1,1),[a.getMonth(),a.getFullYear()]},F=function(b){if(m.picker.is(":visible")){var c,d=parseInt(m.pickerdays.width(),10),e=m.picker[0].offsetHeight;for(void 0!==b&&Array.isArray(b)?(o.cells=b,m.picker.css({width:o.cells[1]*o.monthWidthInPixels+(o.timepicker&&a.fn.TimePicker?87*(o.norange?1:2):0)+50,height:o.cells[0]*o.monthHeightInPixels+o.someYOffset})):o.cells=[Math.floor((e-o.someYOffset)/o.monthHeightInPixels)||1,Math.floor(d/o.monthWidthInPixels)||1],o.cells[0]<0&&(o.cells[0]=1),m.monthcount=o.cells[0]*o.cells[1],I(m.month,m.year),L(),C(),z(),P(m.startinput[0]),c=0;c<m.onAfterRegenerate.length;c+=1)m.onAfterRegenerate[c].call(m)}},G=function(){var c,e,g,i,j,k,l,n,p,q,r,s;m.button.on("click keydown",function(a){if("keydown"===a.type)switch(a.which){case 9:return void(o.inline||T());case 38:case 13:break;default:return}return m.button.is("[disabled]")?(a.preventDefault(),!1):void N()}),o.inline||m.startinput.after(m.button),c=m.startinput.offset(),m.picker.find(".period_picker_submit_dates input").on("focus",function(){a(this).parent().parent().addClass("input_focused_yes")}).on("blur",function(){a(this).parent().parent().removeClass("input_focused_yes")}),m.picker.find(".period_picker_submit_dates .period_picker_date input").on("keydown",function(b){var c=this;clearTimeout(m.timer3),m.timer3=setTimeout(function(){if(a(c).val()){var d=moment(a(c).val(),o.formatDate);if(!d.isValid())return void a(c).parent().parent().addClass("period_picker_error");B([m.picker.find(".period_picker_submit_dates .period_picker_date input").eq(0).val(),m.picker.find(".period_picker_submit_dates .period_picker_date input").eq(1).val()]),13===b.which&&T()}a(c).parent().parent().removeClass("period_picker_error")},2*o.defaultTimeout),b.stopPropagation()}),o.timepicker&&a.fn.TimePicker&&(s=function(b){var c,e=this,f=new d;if(m.currentTimepickerIndex=parseInt(a(m).data("index"),10),a(e).val()){if(c=moment(a(e).val(),o.timepickerOptions.inputFormat),!c.isValid())return void a(e).parent().parent().addClass("period_picker_error");if(m.period&&m.period.length&&f.isEqualDate(m.period[0],m.period[1])&&moment(r.eq(0).val(),o.timepickerOptions.inputFormat).toDate().getTime()>moment(r.eq(1).val(),o.timepickerOptions.inputFormat).toDate().getTime())return void a(e).parent().parent().addClass("period_picker_error");A(m.picker.find(".period_picker_submit_dates .period_picker_time input").eq(0).val(),m.picker.find(".period_picker_submit_dates .period_picker_time input").eq(1).val()),b&&13===b.which&&T()}a(e).parent().parent().removeClass("period_picker_error")},r=m.picker.find(".period_picker_submit_dates .period_picker_time input").on("keydown change",function(a){"keydown"===a.type?(clearTimeout(m.timer3),m.timer3=setTimeout(s.bind(this,a),3*o.defaultTimeout)):s.call(this,a),a.stopPropagation()})),m.picker.find(".period_picker_max_min").on("mousedown click mouseup touchstart touchend",function(a){a.stopPropagation()}).on("mouseup touchend",function(a){m.picker.toggleClass("period_picker_maximize"),F()}),o.fullsizeOnDblClick&&m.picker.find(".period_picker_head").on("dblclick",function(){m.picker.toggleClass("period_picker_maximize"),F()}),m.picker.find(".period_picker_close").on("mousedown mouseup click touchstart touchend",function(a){a.stopPropagation()}).on("click",T),o.mousewheel&&(m.picker.on("mousewheel",function(a){return m.month+=(o.reverseMouseWheel?-1:1)*a.deltaY,F(),!1}),o.mousewheelYearsLine&&m.picker.find(".period_picker_years_selector").on("mousewheel",function(a){return m.year+=(o.reverseMouseWheel?-1:1)*a.deltaY,m.month=1,F(),a.preventDefault(),a.stopPropagation(),!1})),o.navigate&&m.picker.find(".xdsoft_navigate").on("click",function(){return m.month+=a(this).hasClass("xdsoft_navigate_prev")?-1:1,F(),!1}),m.picker.on("click",".period_picker_show.period_picker_today",function(){if(v("onTodayButtonClick")!==!1){var a=new Date;m.year=a.getFullYear(),m.month=a.getMonth()+1,F()}}),m.picker.on("click",".period_picker_show.period_picker_ok",function(){v("onOkButtonClick")!==!1&&T()}),o.clearButtonInButton&&(m.button.find(".icon_clear").on("mouseup touchstart mousedown click",function(a){return a.preventDefault(),a.stopPropagation(),!1}),m.button.find(".icon_clear").on("mousedown",function(a){return O(),a.stopImmediatePropagation(),!1})),o.clearButton&&m.picker.on("click",".period_picker_show.period_picker_clear",function(){O()}),m.picker.on("click touchstart",".period_picker_years_selector .period_picker_year",function(){m.year=parseInt(a(this).text(),10),m.month=-Math.floor(m.monthcount/2)+1,F()}),m.picker.on("mousedown touchstart",".period_picker_days td td,.period_picker_month",function(){if(a(this).hasClass("period_picker_month")){var b=new d,c=b.parseStr(a(this).data("datestart"),o.formatDate),e=b.parseStr(a(this).data("dateend"),o.formatDate);(!m.mindate||c>=m.mindate)&&(!m.maxdate||e<=m.maxdate)&&B([a(this).data("datestart"),a(this).data("dateend")])}else if(!a(this).hasClass("period_picker_gray_period")&&!a(this).hasClass("period_picker_empty"))if(a(this).hasClass("period_picker_selector_week")){var f=parseInt(a(this).parent().data("week"),10),g=m.picker.find("tr[data-week="+f+"] > td.period_picker_cell:not(.period_picker_gray_period)"),h=g.eq(-1),i=g.eq(0);h.length&&B([i.data("date"),h.data("date")])}else 1!==m.picker.find(".period_picker_selected").length?(m.picker.find(".period_picker_selected").removeClass("period_picker_selected"),a(this).addClass("period_picker_selected")):a(this).addClass("period_picker_selected"),B(a(this).data("date"))}),m.picker.on("mousedown touchstart",".period_picker_years_selector_container",function(b){p=a(this),q=!0,e=[h(b).clientX,h(b).clientY,parseInt(p.css("left")||0,10)],b.preventDefault()}),m.picker.on("mousedown touchstart",".period_picker_years_dragger",function(b){k=a(this),j=!0,e=[h(b).clientX,h(b).clientY,parseInt(k.css("left"),10)],b.stopPropagation(),b.preventDefault()}),o.draggable&&m.picker.on("mousedown touchstart",".period_picker_head",function(a){n=!0,e=[h(a).clientX,h(a).clientY,parseInt(m.picker.css("left"),10),parseInt(m.picker.css("top"),10)],a.preventDefault()}),m.picker.on("mouseup touchend",function(b){i=!1,j=!1,n=!1,q=!1,o.timepicker&&a.fn.TimePicker&&m.timepicker.find("input.timepicker").TimePicker("stopDrag"),b.stopPropagation()}),m.picker.find(".period_picker_resizer").on("mousedown touchstart",function(a){i=!0,e=[h(a).clientX,h(a).clientY,parseInt(m.picker.css("width"),10),parseInt(m.picker.css("height"),10)],a.preventDefault()}),o.noHideSourceInputs||o.likeXDSoftDateTimePicker?(m.startinput.add(m.endinput).on("keydown.xdsoftpp mousedown.xdsoftpp touchstart.xdsoftpp",function(){clearTimeout(f),f=setTimeout(function(){var a,b=u(),c=o.timepicker?o.formatDateTime:o.formatDate;(void 0!==b[0]&&b[0]!==m.startinput.val()||void 0!==b[1]&&m.endinput.length&&b[1]!==m.endinput.val())&&(a=new d,B([a.parseStr(m.startinput.val(),c),a.parseStr(m.endinput.val(),c)]),m.period[0]&&(m.year=m.period[0].getFullYear(),m.month=m.period[0].getMonth()+1,F()))},3*o.defaultTimeout)}),o.likeXDSoftDateTimePicker&&(m.button.remove(),m.startinput.add(m.endinput).on("open.xdsoftpp focusin.xdsoftpp mousedown.xdsoftpp touchstart.xdsoftpp",function(){var b=this;a(b).is(":disabled")||m.picker.hasClass("visible")||(clearTimeout(f),f=setTimeout(function(){S(b)},o.defaultTimeout))}),o.hideOnBlur&&m.startinput.add(m.endinput).on("blur.xdsoftpp",function(){setTimeout(function(){m.picker.find("*:focus").length||T()},2*o.defaultTimeout)}))):(m.startinput.hide(),m.endinput.hide()),o.inline&&(m.startinput.after(m.picker),S()),a(b).on("resize.xdsoftpp"+m.uniqueid,F).on("keydown.xdsoftpp"+m.uniqueid,function(a){if(m.picker.hasClass("visible"))switch(a.which){case 40:case 27:o.inline||T();break;case 37:case 39:m.picker.find(".xdsoft_navigate").eq(37===a.which?0:1).trigger("click")}}).on("mouseup.xdsoftpp"+m.uniqueid+" touchend.xdsoftpp"+m.uniqueid,function(a){i||j||n||q?(i=!1,j=!1,n=!1,q=!1):o.inline||(T(),o.likeXDSoftDateTimePicker&&(m.startinput.is(a.target)||m.endinput.is(a.target))&&S(a.target))}).on("mousemove.xdsoftpp"+m.uniqueid+" touchmove.xdsoftpp"+m.uniqueid,function(a){n&&!o.inline&&(g=[h(a).clientX-e[0],h(a).clientY-e[1]],m.picker.hasClass("xdsoft_i_moved")||m.picker.addClass("xdsoft_i_moved"),m.picker.css({left:e[2]+g[0],top:e[3]+g[1]})),i&&(g=[h(a).clientX-e[0],h(a).clientY-e[1]],m.picker.css({width:e[2]+g[0],height:e[3]+g[1]}),F()),j&&(g=[h(a).clientX-e[0],h(a).clientY-e[1]],l=e[2]+g[0],k.css("left",l),K(l),I(m.month,m.year),C()),q&&(g=[h(a).clientX-e[0],h(a).clientY-e[1]],l=e[2]+g[0],p.css("left",l))}),H()},H=function(){o.timepicker&&void 0!==a.fn.TimePicker&&m.timepicker.each(function(){var b=a(this).find("input.timepicker"),c=parseInt(b.data("index")||"0",10);b.length&&!b.data("timepicker")&&void 0!==a.fn.TimePicker&&(c&&o.defaultEndTime&&(o.timepickerOptions.defaultTime=o.defaultEndTime),b.TimePicker(o.timepickerOptions,a(this)),m.onAfterRegenerate.push(function(){b.TimePicker("regenerate")}),b.on("change",function(){var a=m.picker.find(".period_picker_submit_dates .period_picker_time input").eq(c);a.is(":focus")||a.val()===this.value||a.val(this.value).trigger("change")}).trigger("change"))})},I=function(a,b){function c(){var a,b=[];for(a=0;a<h.length;a+=1)b.push('<th class="'+(o.weekEnds.indexOf(a+o.dayOfWeekStart>7?(a+o.dayOfWeekStart)%7:a+o.dayOfWeekStart)!==-1?"period_picker_holiday":"")+'">'+h[a]+"</th>");return b.join("")}var e,f=[],g=E(),h=(new d).weekdays(o.dayOfWeekStart);for(g[1]>o.yearsPeriod[1]&&(m.year=o.yearsPeriod[1],b=m.year,m.month=12-m.monthcount,a=m.month),g[1]<o.yearsPeriod[0]&&(m.year=o.yearsPeriod[0],b=m.year,m.month=1,a=m.month),f.push('<tr class="period_picker_first_letters_tr">'),e=0;e<o.cells[1];e+=1)f.push('<td class="period_picker_first_letters_td"><table class="period_picker_first_letters_table"><tbody><tr><th class="period_picker_selector_week_cap"><span class="period_picker_selector_week_cap"></span></th>'+c()+"</tr></tbody></table></td>");for(f.push("</tr>"),e=0;e<o.cells[0];e+=1)f.push("<tr>"),f.push(M(a+e*o.cells[1],b,o.cells[1])),f.push("</tr>");m.calendarbox.html(f.join("")),z()},J=function(){var a=E();return(a[1]-o.yearsPeriod[0])*o.yearSizeInPixels+a[0]*Math.floor(o.yearSizeInPixels/12)},K=function(a){m.year=Math.floor(a/o.yearSizeInPixels)+o.yearsPeriod[0],m.month=Math.floor(a%o.yearSizeInPixels/Math.floor(o.yearSizeInPixels/12))+1},L=function(){if(o.yearsLine){var b,c=[],d=0;if(c.push('<div class="period_picker_years_dragger" title="'+p("Move to select the desired period")+'" style="left: '+J()+"px; width: "+Math.floor(o.yearSizeInPixels/12)*m.monthcount+'px;"></div>'),c.push('<div class="period_picker_years_period" style="display: block; width: 0; left: 300px;"></div>'),o.yearsPeriod&&a.isArray(o.yearsPeriod))for(b=o.yearsPeriod[0];b<=o.yearsPeriod[1];b+=1)c.push('<div class="period_picker_year" style="left:'+d*o.yearSizeInPixels+'px">'+b+"</div>"),d+=1;m.yearsline.css("width",d*o.yearSizeInPixels+"px"),m.yearsline.html(c.join(""))}},M=function(a,b,c){var e,f,g,h,i,j,k=[],l=new d,n=(new d).format("DD.MM.YYYY");for(l.setDate(1),l.setFullYear(b),l.setMonth(a-1),e=0;e<c;e+=1){for(i=l.getMonth()+1,h=l.countDaysInMonth(),k.push('<td class="period_picker_month'+l.format("M")+'"><table><tbody>'),k.push('<tr><th class="period_picker_month" data-datestart="'+l.format(o.formatDate)+'"  data-dateend="'+l.clone(0,0,h).format(o.formatDate)+'" colspan="8" title="'+l.format(o.formatMonth)+'">'+l.format(o.formatMonth)+"<b>"+l.format("M.YYYY")+"</b></th></tr>"),j=0;l.format("E")!==o.dayOfWeekStart&&j<7;)l.setDate(l.getDate()-1),j+=1;for(f=1,j=0;f<=h&&j<100;){for(k.push('<tr data-week="'+l.format("W")+'">'),k.push('<td class="period_picker_selector_week" title="'+p("Select week #")+" "+l.format("W")+'"><span class="period_picker_selector_week"></span></td>'),g=1;g<=7;g+=1)l.format("M")!==i?k.push('<td class="period_picker_empty">&nbsp;</td>'):((!m.maxdate||l<m.maxdate)&&(!m.mindate||l>m.mindate)&&o.disableDays.indexOf(l.format(o.formatDate))===-1?(k.push('<td data-date="'+l.format(o.formatDate)+'"'),k.push('    class="period_picker_cell '),k.push(o.weekEnds.indexOf(l.format("E"))!==-1||o.holidays.indexOf(l.format(o.formatDate))!==-1?" period_picker_holiday":" period_picker_weekday"),l.format("DD.MM.YYYY")===n&&k.push(" period_picker_cell_today "),k.push((7===g||l.format("D")===h?" period_picker_last_cell":"")+'">'+l.format("D")+"</td>")):k.push('<td class="period_picker_gray_period">'+l.format("D")+"</td>"),f+=1),l.setDate(l.getDate()+1);j+=1,k.push("</tr>")}a+=1,l.setDate(1),l.setFullYear(b),l.setMonth(a-1),k.push("</tbody></table></td>")}return k.join("")},N=function(){m.picker.hasClass("active")?T():S()},O=function(){B(),o.onClearButtonClick&&a.isFunction(o.onClearButtonClick)&&o.onClearButtonClick.call(m),o.closeAfterClear&&!o.inline&&T()},P=function(a){R&&!m.picker.hasClass("xdsoft_i_moved")&&m.picker.css(Q(a))},Q=function(c){var d=o.likeXDSoftDateTimePicker?a(c).offset():m.button.offset(),e=0,f=0;return e=d.top+(o.likeXDSoftDateTimePicker?a(c).outerHeight():m.button.outerHeight())-1,f=d.left,e+m.picker.outerHeight()>a(b).height()+a(b).scrollTop()&&(e=d.top-m.picker.outerHeight()-1),e<0&&(e=0),f+m.picker.outerWidth()>a(b).width()&&(f=a(b).width()-m.picker.outerWidth()),o.placement.toLowerCase().split(/\s/).forEach(function(b){switch(b){case"right":f=d.left+m.button.outerWidth();break;case"left":f=d.left-m.picker.outerWidth();break;case"top":e=d.top-m.picker.outerHeight();break;case"bottom":e=d.top+(o.likeXDSoftDateTimePicker?a(c).outerHeight():m.button.outerHeight())-1}}),{left:f,top:e}},R=!1,S=function(b){if(!R){R=!0,o.inline||(m.picker.parent().length||a(c.body).append(m.picker),m.picker.addClass("visible"),o.defaultTimeout?setTimeout(function(){m.picker.addClass("active")},o.defaultTimeout):m.picker.addClass("active"),o.fullsize?m.picker.addClass("period_picker_maximize"):m.picker.hasClass("xdsoft_i_moved")||P(b)),F();for(var d=0;d<m.onAfterShow.length;d+=1)m.onAfterShow[d].call(m)}},T=function(){if(R&&(R=!1,m.picker.hasClass("visible")&&(m.picker.removeClass("active"),m.picker.hasClass("animation")&&o.defaultTimeout?setTimeout(function(){m.picker.hasClass("active")||m.picker.removeClass("visible")},3*o.defaultTimeout):m.picker.removeClass("visible"),void 0!==m.onAfterHide&&m.onAfterHide.length)))for(var a=0;a<m.onAfterHide.length;a+=1)m.onAfterHide[a].call(m)},U=!1,V=function(){U||(U=!0,m.picker.remove(),m.button.remove(),m.startinput.off(".xdsoftpp").show().removeData("periodpicker"),m.endinput.off(".xdsoftpp").show(),a(b).off(".xdsoftpp"+m.uniqueid),e.instances[m.startinput.id||"picker"+m.uniqueid]=void 0,delete e.instances[m.startinput.id||"picker"+m.uniqueid],m.startinput.removeData("periodpicker"))};l=new d,n[0]=m.startinput.val(),n[1]=m.endinput.val(),q(),B([l.parseStr(n[0],o.timepicker?o.formatDateTime:o.formatDate)||l.parseStr(n[0],o.formatDate),l.parseStr(n[1],o.timepicker?o.formatDateTime:o.formatDate)||l.parseStr(n[1],o.formatDate)]),m.onAfterShow=[],m.onAfterHide=[],m.onAfterRegenerate=[],m.uniqueid=g,e.instances[m.startinput.id||"picker"+m.uniqueid]=m,m.currentTimepickerIndex=0,m.timepickerSetLimits=!1,m.timer1=0,m.timer2=0,m.timer3=0,g+=1,G(),o.timepicker&&void 0!==a.fn.TimePicker&&A(l.parseStr(n[0],o.formatDateTime)||l.parseStr(n[0],o.formatDate),l.parseStr(n[1],o.formatDateTime)||l.parseStr(n[1],o.formatDate)),m.returnPeriod=r,
m.getInputsValue=u,m.getLabel=x,m.setLabel=y,m.regenerate=F,m.clear=O,m.addRange=B,m.addRangeTime=A,m.toggle=N,m.show=S,m.hide=T,m.applyOptions=q,m.destroy=V}var f,g=0,h=function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]?a.originalEvent.touches[0]:a},i=function(a,b){(b||void 0===b)&&a.is(":hidden")?a.each(function(){this.style.display=""}):b||a.hide()};e.instances={},b.PeriodPicker=e,b.TimeWrapper=d,a.fn.periodpicker=function(c,f,g){if(void 0===b.moment)throw new Error("PeriodPicker's JavaScript requires MomentJS");var h=this;return this.each(function(){var b,i,j=[],k=a(this),l=k.data("periodpicker");if(l)switch(b=l.options,c){case"picker":h=l;break;case"regenerate":l.regenerate(f);break;case"setOption":l.options[f]=g,l.applyOptions();break;case"setOptions":l.options=a.extend(!0,{},l.options,f),l.applyOptions();break;case"clear":l.addRange();break;case"change":i=new d,j[0]=i.parseStr(l.startinput.val(),b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(l.startinput.val(),b.formatDate),l.endinput.length&&(j[1]=i.parseStr(l.endinput.val(),b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(l.endinput.val(),b.formatDate)),l.addRange(j);break;case"destroy":l.destroy();break;case"hide":l.hide();break;case"show":l.show();break;case"value":void 0!==f?(i=new d,a.isArray(f)?(j[0]=i.parseStr(f[0],b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(f[0],b.formatDate),void 0!==f[1]&&(j[1]=i.parseStr(f[1],b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(f[1],b.formatDate))):j[0]=i.parseStr(f,b.timepicker?b.formatDateTime:b.formatDate)||i.parseStr(f,b.formatDate),l.addRange(j),b.timepicker&&void 0!==a.fn.TimePicker&&l.addRangeTime(j[0],j[1]||j[0])):h=l.period;break;case"valueStringStrong":h=l.getInputsValue().join("-");break;case"valueString":h=l.getLabel().join("-");break;case"disable":l.button.attr("disabled",!0),l.startinput.add(l.endinput).attr("disabled",!0).attr("readonly",!0);break;case"enable":l.button.removeAttr("disabled"),l.startinput.add(l.endinput).removeAttr("disabled").removeAttr("readonly")}else l=new e(this,c),k.data("periodpicker",l)}),h},e.defaultOptions=a.fn.periodpicker.defaultOptions={buttonClassSuffix:"",tabIndex:0,animation:!0,lang:"en",i18n:{en:{"Select week #":"Select week #","Select period":"Select period","Select date":"Select date","Choose period":"Select period","Choose date":"Select date",Clear:"Clear"},ru:{"Move to select the desired period":"Переместите, чтобы выбрать нужный период","Select week #":"Выбрать неделю №","Select period":"Выбрать период","Select date":"Выбрать дату","Open fullscreen":"Открыть на весь экран",Close:"Закрыть",OK:"OK","Choose period":"Выбрать период","Choose date":"Выбрать дату",Clear:"Отчистить"},fr:{"Move to select the desired period":"Déplacer pour sélectionner la période désirée","Select week #":"Sélectionner la semaine #","Select period":"Choisissez une date","Select date":"Sélectionner la date","Open fullscreen":"Ouvrir en plein écran",Close:"Fermer",OK:"OK","Choose period":"Choisir la période","Choose date":"Choisir une date",Clear:"Propre"}},withoutBottomPanel:!1,showTimepickerInputs:!0,showDatepickerInputs:!0,timepicker:!1,useTimepickerLimits:!0,timepickerOptions:{inputFormat:"HH:mm"},defaultEndTime:!1,yearsLine:!0,title:!0,inline:!1,clearButtonInButton:!1,clearButton:!1,closeAfterClear:!0,okButton:!0,todayButton:!1,closeButton:!0,fullsizeButton:!0,resizeButton:!0,navigate:!0,fullsizeOnDblClick:!0,fullsize:!1,draggable:!0,mousewheel:!0,mousewheelYearsLine:!0,reverseMouseWheel:!0,hideAfterSelect:!1,hideOnBlur:!0,norange:!1,timePickerInRight:!1,formatMonth:"MMMM YYYY",formatDecoreDate:"D MMMM",formatDecoreDateWithYear:"D MMMM YYYY",formatDecoreDateWithoutMonth:"D",formatDecoreDateTimeWithoutMonth:"HH:mm D",formatDecoreDateTime:"HH:mm D MMMM",formatDecoreDateTimeWithYear:"HH:mm D MMMM YYYY",formatDateTime:"HH:mm YYYY/MM/D",formatDate:"YYYY/MM/D",end:"",noHideSourceInputs:!1,likeXDSoftDateTimePicker:!1,startMonth:null,startYear:null,dayOfWeekStart:1,yearSizeInPixels:120,timepickerWidthInPixels:50,monthWidthInPixels:184,monthHeightInPixels:174,someYOffset:150,yearsPeriod:[null,null],weekEnds:[6,7],holidays:[],disableDays:[],minDate:!1,maxDate:!1,cells:[1,3],utcOffset:null,placement:"bottom",onTodayButtonClick:!1,onOkButtonClick:!1,onAfterShow:!1,onAfterHide:!1,onAfterRegenerate:!1,onClearButtonClick:!1,onFromSelected:!1,onToSelected:!1,onFromChanged:!1,onToChanged:!1,defaultTimeout:100}}(jQuery,window,document),void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(a,b){var c,d;for(d=that.length,c=b||0;c<d;c+=1)if(that[c]===a)return c;return-1});